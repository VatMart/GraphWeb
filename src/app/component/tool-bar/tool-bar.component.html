<div class="toolbar-main-container" [ngClass]="isAlgorithmModeActive ? 'alg-background' : ''">

  <!-- Common gradient -->
  <svg style="height: 0; width: 0; position: absolute;" aria-hidden="true" focusable="false">
    <defs>
      <linearGradient id="commonGradient" x1="100%" y1="100%" x2="0%" y2="0%">
        <stop offset="0%" stop-color="#ff0000"/>
        <stop offset="100%" stop-color="#FFC618"/>
      </linearGradient>
    </defs>
  </svg>

  <span class="logo-container" [ngClass]="isAlgorithmModeActive ? 'alg-background' : ''">
    <span class="image-container" [ngClass]="isAlgorithmModeActive ? 'image-container-alg' : ''">
      <img [ngSrc]="isAlgorithmModeActive ? 'assets/logo.png' : 'assets/logo_white.png'" alt="Graph Web Logo"
           class="logo-toolbar" height="251" width="249"/>
    </span>
    <!-- Conditional display for Non-Mobile Devices -->
    <label class="logo-label" *ngIf="!isMobileDevice">GraphWeb</label>
  </span>

  <!-- For debugging. TODO hide on prod -->
  <span *ngIf="!isMobileDevice" class="coordinates-panel" [ngClass]="isAlgorithmModeActive ? 'alg-background' : ''">
    <span>X: <span>{{ xCursor | number:'1.0-0' }}</span></span>
    <span>Y: <span>{{ yCursor | number:'1.0-0' }}</span></span>
  </span>

  <!-- Toggle Button for Vertex Addition -->
  <button pRipple pTooltip="Toggle Add/Remove vertices mode" tooltipPosition="bottom" showDelay="200"
          id="buttonAddVertex"
          class="graph-web-toggle-button"
          [class.active]="isAddVertexButtonActive"
          [hidden]="isAlgorithmModeActive"
          (click)="onToggleAddVertexButton()"
          (mouseleave)="buttonAddVertexMouseLeave()"
          (mousedown)="buttonAddVertexMouseDown()"
          (mouseup)="buttonAddVertexMouseUp()">
    <svg width="35" height="39" viewBox="0 -72 650 830"
         [attr.fill]="useAddVertexGradient ? 'url(#grad1)' : 'currentColor'"
         xmlns="http://www.w3.org/2000/svg">
      <!-- Gradient Definition -->
      <ng-container *ngIf="useAddVertexGradient">
        <defs>
          <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" [attr.stop-color]="gradientColorStart"/>
            <stop offset="100%" [attr.stop-color]="gradientColorEnd"/>
          </linearGradient>
        </defs>
      </ng-container>
      <path
        d="M 204.81284,81.390908 A 321.96531,321.96531 0 0 1 370.48714,63.452848 319.94154,319.94154 0 0 1 611.685,510.15675 321.96531,321.96531 0 0 1 567.71378,581.35708 l 51.14649,70.55637 c 16.09822,22.07759 -12.97049,62.3693 -36.24398,80.30742 -25.7573,19.86986 -80.03142,38.54383 -96.31379,16.00628 L 434.97214,677.39476 A 321.96531,321.96531 0 0 1 269.2059,695.33279 320.12553,320.12553 0 0 1 3.9984959,328.84427 321.96531,321.96531 0 0 1 72.07117,177.52057 L 20.55671,106.68821 C 4.4584479,84.334598 35.91907,43.858948 59.83649,25.920888 85.04178,6.9709284 136.83219,-12.346982 153.11446,10.098608 Z M 188.89858,273.46624 h -58.41369 v 50.13459 h 58.41369 v 58.04575 h 50.13465 v -57.95376 h 58.4136 v -50.22658 h -58.4136 v -58.13775 h -50.13465 z m -34.40426,275.14234 c 23.64141,27.68904 57.40176,46.27103 91.25414,58.59771 99.07341,34.95624 218.10861,-7.08324 273.21062,-96.58959 59.14963,-89.41438 46.36291,-219.2124 -32.38059,-292.89646 l -0.82816,-0.0921 z M 482.16303,446.22363 V 496.5422 H 315.75297 v -50.41058 z"/>
    </svg>
  </button>

  <!-- Toggle Button for Edge Addition -->
  <button pRipple pTooltip="Toggle Add/Remove edges mode" tooltipPosition="bottom" showDelay="200"
          id="buttonAddEdge"
          class="graph-web-toggle-button"
          [class.active]="isAddEdgesButtonActive"
          [hidden]="isAlgorithmModeActive"
          (click)="onToggleAddEdgesButton()"
          (mouseleave)="buttonAddEdgesMouseLeave()"
          (mousedown)="buttonAddEdgesMouseDown()"
          (mouseup)="buttonAddEdgesMouseUp()">
    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="39" viewBox="0.28 -0.6 5 6.2"
         [attr.fill]="useAddEdgesGradient ? 'url(#grad2)' : 'currentColor'">
      <!-- Gradient Definition -->
      <ng-container *ngIf="useAddEdgesGradient">
        <defs>
          <linearGradient id="grad2" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" [attr.stop-color]="gradientColorStart"/>
            <stop offset="100%" [attr.stop-color]="gradientColorEnd"/>
          </linearGradient>
        </defs>
      </ng-container>
      <path
        d="M4.009 0v.004c-.858 0-1.554.681-1.554 1.522 0 .393.156.771.434 1.055l.004.006.01.006a1.58 1.58 0 0 0 1.686.333c.567-.221.967-.794.967-1.393.008-.393-.163-.776-.432-1.063L5.096.442 5.099.44A1.57 1.57 0 0 0 4.009 0m-.677.675h.256v.291h.299v.252h-.299v.291h-.256v-.291h-.3V.966h.3V.8Zm1.52.009h.004c.403.37.469 1.021.166 1.47-.282.448-.891.66-1.399.484a1.1 1.1 0 0 1-.467-.294ZM.798.736A.79.79 0 0 0 0 1.518c0 .43.36.783.8.783l.016-.002.437 1.778a.78.78 0 0 0-.442.696c0 .43.358.783.797.783a.8.8 0 0 0 .785-.636l1.188-.014c.071.36.395.633.782.633.44 0 .8-.351.8-.781s-.36-.784-.8-.784a.795.795 0 0 0-.765.576l-1.223.013a.8.8 0 0 0-.767-.572l-.442-1.783a.8.8 0 0 0 .151-.1l.192.172.247-.26-.221-.2a.8.8 0 0 0 .062-.302A.79.79 0 0 0 .8.736m0 .26c.296 0 .531.232.531.522s-.235.522-.53.522a.526.526 0 0 1-.534-.522c0-.29.238-.521.533-.521m3.183.835v.251h.851v-.251H4.11Zm-1.96.429-.247.263.267.24.247-.261Zm.535.484-.247.261.267.242.247-.26Zm.533.483-.247.263.268.242.246-.263Zm.536.484-.248.262.266.242.248-.261Zm.737.525c.296 0 .533.232.533.522s-.237.52-.533.52a.523.523 0 0 1-.53-.52c0-.29.235-.522.53-.522m-2.755.016c.296 0 .534.232.534.521s-.238.522-.534.522a.524.524 0 0 1-.53-.522c0-.29.235-.52.53-.52"/>
    </svg>
  </button>

  <!-- Button for Clear graph -->
  <button pRipple pTooltip="Clear graph" tooltipPosition="bottom" showDelay="200"
          class="graph-web-button"
          [hidden]="isAlgorithmModeActive"
          (click)="onClearGraph()"
          (mouseleave)="useClearGradient = false"
          (mousedown)="useClearGradient = true"
          (mouseup)="useClearGradient = false">
    <svg xmlns="http://www.w3.org/2000/svg" width="35" height="39" viewBox="0.28 -0.6 5 6.2"
         [attr.fill]="useClearGradient ? 'url(#commonGradient)' : 'currentColor'">
      <path
        d="M3.92.024a.74.74 0 0 0-.523.215L3.35.288 3.347.29l-.548.547-.003.005-1.301 1.301a.74.74 0 0 0-.001 1.045l.873.871a.74.74 0 0 0 1.045 0l1.903-1.903a.74.74 0 0 0 0-1.045l-.007-.008-.003-.002-.852-.853L4.45.247 4.443.238A.73.73 0 0 0 3.92.024m-1.354 1.56a.7.7 0 0 0 .19.36l.853.852a.7.7 0 0 0 .359.19l-.815.815a.37.37 0 0 1-.53.001L1.75 2.93a.37.37 0 0 1 0-.53ZM.89 3.74a.872.3 0 0 0-.872.3.872.3 0 0 0 .83.299l.382.54a.99.34 0 0 0-.615.316.99.34 0 0 0 .99.34.99.34 0 0 0 .928-.224l1.008-.003a.895.308 0 0 0 .75.14.895.308 0 0 0 .894-.308.895.308 0 0 0-.894-.308.895.308 0 0 0-.334.022L1.71 4.14a.872.3 0 0 0 .052-.101.872.3 0 0 0-.871-.3m.455.555 2.174.69a.895.308 0 0 0-.086.067l-.927.003a.99.34 0 0 0-.901-.2.99.34 0 0 0-.079 0l-.373-.53a.872.3 0 0 0 .192-.03"/>
    </svg>
  </button>

  <!-- Undo button -->
  <button pRipple pTooltip="Undo (Ctrl-Z)" tooltipPosition="bottom" showDelay="200"
          class="graph-web-button"
          [hidden]="isAlgorithmModeActive"
          (click)="undoAction()"
          (mouseleave)="useUndoGradient = false"
          (mousedown)="useUndoGradient = true"
          (mouseup)="useUndoGradient = false"
          [disabled]="!canUndo">
    <svg width="35px" height="39px" viewBox="2 2 20 18" fill="none"
         xmlns="http://www.w3.org/2000/svg">
      <path
        d="M17 13C16.5367 11.9961 15.7497 11.1655 14.7576 10.6333C13.7655 10.1011 12.622 9.89624 11.4994 10.0495C9.66479 10.3 8.38607 11.6116 7 12.8186M7 10V13H10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
        [attr.stroke]="useUndoGradient ? 'url(#commonGradient)' : 'currentColor'" stroke-width="1.7"
        stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <!-- Redo button -->
  <button pRipple pTooltip="Redo (Ctrl-Y)" tooltipPosition="bottom" showDelay="200"
          class="graph-web-button"
          (click)="redoAction()"
          [hidden]="isAlgorithmModeActive"
          (mouseleave)="useRedoGradient = false"
          (mousedown)="useRedoGradient = true"
          (mouseup)="useRedoGradient = false"
          [disabled]="!canRedo">
    <svg width="35px" height="39px" viewBox="2 2 20 18" fill="none"
         xmlns="http://www.w3.org/2000/svg">
      <path
        d="M7 13C7.4633 11.9961 8.25029 11.1655 9.2424 10.6333C10.2345 10.1011 11.378 9.89624 12.5006 10.0495C14.3352 10.3 15.6139 11.6116 17 12.8186M17 10V13H14M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z"
        [attr.stroke]="useRedoGradient ? 'url(#commonGradient)' : 'currentColor'" stroke-width="1.7"
        stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>

  <!-- ALGORITHM MODE. Reset mode button -->
  <span *ngIf="isAlgorithmModeActive">
      <button pRipple pTooltip="Reset algorithm. Gives ability to set input settings for the algorithm again" tooltipPosition="bottom" showDelay="200"
              class="pi pi-refresh alg-mode-button"
              style="font-size: 2rem;"
              [disabled]="!canReset"
              (click)="onResetButton()">
        <a class="alg-button-text">Reset</a>
      </button>
  </span>
  <!-- Right side placed buttons -->
  <p-menu #algorithmsItemsMenu [model]="algorithmsItems" [popup]="true"/>
  <div class="move-right">
    <!-- ALGORITHM MODE. Exit from algorithm mode button -->
    <span *ngIf="isAlgorithmModeActive">
      <button pRipple pTooltip="Exit from algorithm mode" tooltipPosition="bottom" showDelay="200"
              class="pi pi-times-circle alg-mode-button" style="font-size: 2rem"
              (click)="onExitAlgMode()">
        <a class="alg-button-text" *ngIf="!isMobileDevice">Exit</a>
      </button>
    </span>
    <!-- Select algorithms button (only on desktop version) -->
    <div *ngIf="!isMobileDevice">
      <button pRipple pTooltip="Select algorithm, and activate algorithm mode" tooltipPosition="right" showDelay="200"
              class="graph-web-button algorithm-button"
              style="padding-inline: 3px"
              [ngClass]="isAlgorithmModeActive ? 'alg-background' : ''"
              (click)="algorithmsItemsMenu.toggle($event)">
        Algorithms
        <svg xmlns="http://www.w3.org/2000/svg" width="39px" height="39px" viewBox="-5 -5 32 32">
          <path fill="currentColor"
                d="m14.996 13.038 2.266-.22a3.5 3.5 0 0 0 3.238 2.181c1.93 0 3.5-1.57 3.5-3.5s-1.57-3.5-3.5-3.5a3.5 3.5 0 0 0-3.432 2.829l-2.458.238a5 5 0 0 0-.957-1.456l1.839-2.776c.321.098.655.166 1.008.166C18.43 7 20 5.43 20 3.5S18.43 0 16.5 0 13 1.57 13 3.5c0 .851.318 1.622.824 2.229L12.029 8.44C11.407 8.162 10.724 8 10 8s-1.407.162-2.029.44L6.176 5.729A3.47 3.47 0 0 0 7 3.5C7 1.57 5.43 0 3.5 0S0 1.57 0 3.5 1.57 7 3.5 7c.353 0 .687-.068 1.008-.166L6.347 9.61A4.97 4.97 0 0 0 5 13c0 1.129.391 2.161 1.025 2.999l-1.112 1.304A3.5 3.5 0 0 0 3.501 17c-1.93 0-3.5 1.57-3.5 3.5s1.57 3.5 3.5 3.5 3.5-1.57 3.5-3.5c0-.7-.212-1.35-.567-1.898l1.094-1.283a4.94 4.94 0 0 0 2.473.681 4.95 4.95 0 0 0 2.948-.982l2.367 2.049a3.5 3.5 0 0 0-.315 1.434c0 1.93 1.57 3.5 3.5 3.5s3.5-1.57 3.5-3.5-1.57-3.5-3.5-3.5a3.47 3.47 0 0 0-1.875.555l-2.338-2.023a4.94 4.94 0 0 0 .709-2.493ZM20.5 10c.827 0 1.5.673 1.5 1.5s-.673 1.5-1.5 1.5-1.5-.673-1.5-1.5.673-1.5 1.5-1.5m-4-8c.827 0 1.5.673 1.5 1.5S17.327 5 16.5 5 15 4.327 15 3.5 15.673 2 16.5 2M2 3.5C2 2.673 2.673 2 3.5 2S5 2.673 5 3.5 4.327 5 3.5 5 2 4.327 2 3.5M3.5 22c-.827 0-1.5-.673-1.5-1.5S2.673 19 3.5 19s1.5.673 1.5 1.5S4.327 22 3.5 22m6.5-6c-1.654 0-3-1.346-3-3s1.346-3 3-3 3 1.346 3 3-1.346 3-3 3m8.5 3c.827 0 1.5.673 1.5 1.5s-.673 1.5-1.5 1.5-1.5-.673-1.5-1.5.673-1.5 1.5-1.5"/>
        </svg>
      </button>
    </div>

    <div *ngIf="!isMobileDevice">
      <!-- Zoom (lens) button (only on desktop version) -->
      <p-menu #zoomMenu [model]="zoomItems" [popup]="true"/>
      <button pRipple pTooltip="Zoom level" tooltipPosition="bottom" showDelay="200"
              class="graph-web-button"
              id="mbScale"
              style="padding-inline: 3px; min-width: 88px; justify-content: flex-end;"
              [ngClass]="isAlgorithmModeActive ? 'algorithm-button alg-background' : ''"
              (click)="zoomMenu.toggle($event)">
        {{ zoomPercentage.toFixed() }}%
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="31" viewBox="-1 -0.5 7 7" fill="none">
          <path
            d="M2.142.151C1.272.134.454.802.294 1.657.11 2.48.56 3.385 1.324 3.738c.436.212.954.245 1.412.088a.83.83 0 0 0 .753.247c.375.41.742.825 1.12 1.23.247.244.688.017.694-.31.007-.248-.227-.389-.363-.566L4.1 3.5c.05-.248-.068-.496-.253-.657.375-.753.153-1.737-.505-2.26a1.9 1.9 0 0 0-1.2-.43m0 .693c.634-.016 1.181.568 1.165 1.194.016.626-.53 1.21-1.165 1.194-.634.015-1.18-.569-1.164-1.194C.966 1.41 1.502.834 2.142.846"
            fill="currentColor"/>
        </svg>
      </button>
    </div>

    <div class="save-file-form" *ngIf="showSaveFileForm">
      <input type="text" [(ngModel)]="filename" placeholder="Enter filename"/>
      <button (click)="saveGraphClick()">Save Graph</button>
    </div>

    <!-- Settings menu -->
    <p-menu #settingMenu [model]="settingsItems" [popup]="true" (onShow)="cdr.detectChanges();">
      <ng-template pTemplate="item" let-item>
        <a pRipple *ngIf="item.id === 'saveGraph'"
           class="p-menuitem-link"
           [class.disabled]="isAlgorithmModeActive"
           [attr.aria-disabled]="isAlgorithmModeActive ? 'true' : null"
           (click)="saveGraphClick()">
          <i class="pi pi-save" style="font-size: 1rem"></i>
          <span class="ml-1">{{ item.label }}</span>
          <p-badge severity="help" class="ml-auto" value="Ctrl+S" [badgeDisabled]="isAlgorithmModeActive"/>
        </a>
        <a pRipple *ngIf="item.id === 'loadGraph'"
           class="p-menuitem-link"
           [class.disabled]="isAlgorithmModeActive"
           [attr.aria-disabled]="isAlgorithmModeActive ? 'true' : null"
           (click)="loadGraphClick()">
          <i class="pi pi-file-arrow-up" style="font-size: 1rem"></i>
          <span class="ml-1">{{ item.label }}</span>
        </a>
        <a pRipple *ngIf="item.id === 'exportItems'"
           class="p-menuitem-link"
           (click)="openExportItemsSubMenu($event, exportSubMenu)">
          <i class="pi pi-file-export" style="font-size: 1rem"></i>
          <span class="ml-1">{{ item.label }}</span>
          <i class="pi pi-angle-right move-right"></i>
        </a>
        <a pRipple *ngIf="item.id === 'zoomLevels' && isMobileDevice"
           class="p-menuitem-link"
           (click)="openZoomSubMenu($event, zoomSubMenu)">
          <i class="pi pi-search" style="font-size: 1rem"></i>
          <span class="ml-1">{{ item.label }}</span>
          <i class="pi pi-angle-right move-right"></i>
        </a>
        <p-checkbox pRipple class="p-menuitem-link" [label]="item.label"
                    [formControl]="showGrid"
                    [binary]="true" inputId="binary"
                    (click)="onCheckboxClick($event, 'showGrid')"
                    *ngIf="item.id === 'showGrid'">
        </p-checkbox>
        <p-checkbox pRipple class="p-menuitem-link" [label]="item.label"
                    [formControl]="hideHelper"
                    [binary]="true" inputId="binary"
                    (click)="onCheckboxClick($event, 'hideHelper')"
                    *ngIf="item.id === 'hideHelper'">
        </p-checkbox>
        <p-checkbox pRipple pTooltip="Center force attracts vertices to center mass" tooltipPosition="left"
                    class="p-menuitem-link" [label]="item.label"
                    [formControl]="enableCenterForce"
                    [binary]="true" inputId="binary"
                    (click)="onCheckboxClick($event, 'enableCenterForce')"
                    *ngIf="item.id === 'enableCenterForce'">
        </p-checkbox>
        <p-checkbox pRipple pTooltip="Link force attracts connected vertices closer to each other"
                    tooltipPosition="left"
                    class="p-menuitem-link" [label]="item.label"
                    [formControl]="enableLinkForce"
                    [binary]="true" inputId="binary"
                    (click)="onCheckboxClick($event, 'enableLinkForce')"
                    *ngIf="item.id === 'enableLinkForce'">
        </p-checkbox>
        <div class="dropdown-select-item-container" (click)="$event.stopPropagation();"
             *ngIf="item.id === 'selectOrientation'">
          <p-dropdown class="custom-select"
                      [options]="orientations"
                      [formControl]="selectedOrientation"
                      (click)="$event.stopPropagation();"
                      optionValue="value"
                      optionLabel="label">
            <ng-template pTemplate="selectedItem">
              <div *ngIf="selectedOrientation.value">
                <div>{{ selectedOrientation.value }}</div>
              </div>
            </ng-template>
            <ng-template let-orientation pTemplate="item">
              <div pRipple>{{ orientation.label }}</div>
            </ng-template>
          </p-dropdown>
        </div>
        <!-- Algorithms selection -->
        <a pRipple *ngIf="item.id === 'algorithms' && isMobileDevice"
           class="p-menuitem-link"
           (click)="openAlgorithmSubMenu($event, algorithmsItemsMenu)">
          <span class="ml-1" style="color: #fe6b00">{{ item.label }}</span>
          <i class="pi pi-angle-right move-right"></i>
        </a>
      </ng-template>
    </p-menu>
    <p-menu #exportSubMenu [model]="exportItems" [popup]="true"></p-menu>
    <p-menu #zoomSubMenu [model]="zoomItems" [popup]="true"></p-menu>
    <!-- Settings menu button -->
    <button pRipple pTooltip="Settings" tooltipPosition="left" showDelay="200"
            class="graph-web-button"
            [ngClass]="isAlgorithmModeActive ? 'algorithm-button alg-background' : ''"
            id="tbSettings"
            (click)="settingMenu.toggle($event)">
      <svg xmlns="http://www.w3.org/2000/svg" height="39" viewBox="10 -940 900 900" width="39">
        <path fill="currentColor"
              d="M280-420q25 0 42.5-17.5T340-480t-17.5-42.5T280-540t-42.5 17.5T220-480t17.5 42.5T280-420m200 0q25 0 42.5-17.5T540-480t-17.5-42.5T480-540t-42.5 17.5T420-480t17.5 42.5T480-420m200 0q25 0 42.5-17.5T740-480t-17.5-42.5T680-540t-42.5 17.5T620-480t17.5 42.5T680-420M480-80q-83 0-156-31.5T197-197t-85.5-127T80-480t31.5-156T197-763t127-85.5T480-880t156 31.5T763-763t85.5 127T880-480t-31.5 156T763-197t-127 85.5T480-80m0-80q134 0 227-93t93-227-93-227-227-93-227 93-93 227 93 227 227 93m0-320"/>
      </svg>
    </button>
  </div>
</div>
